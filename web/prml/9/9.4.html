<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>9.4. 一般のEMアルゴリズム</title>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["tex2jax.js"],
        jax: ["input/TeX","output/HTML-CSS"],
        tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
      });
    </script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
    <!-- <script type="text/javascript" src="MathJax/MathJax.js" ></script> -->
</head>
<body>
  <h1>9.4. 一般のEMアルゴリズム</h1>

$X$ : 観測変数 <br/>
$Z$ : 潜在変数 <br/>
$\theta$ : パラメータ <br/>

$$
p(X \mid \theta) = \sum_Z p(X,Z \mid \theta)
\tag{9.69}
$$

$$
\ln p(X \mid \theta) = L(q, \theta) + KL(q \mid\mid p)
\tag{9.70}
$$

$$
L(q, \theta) = \sum_Z q(Z) \ln \frac{p(X, Z \mid \theta)}{q(Z)}
\tag{9.71}
$$

$$
KL(q \mid\mid p) = - \sum_Z q(Z) \ln \frac{p(Z \mid X, \theta)}{q(Z)}
\tag{9.72}
$$

$$
\ln p(X, Z \mid \theta) = \ln ( p(Z \mid X, \theta) \cdot p(X \mid \theta) )
= \ln p(Z \mid X, \theta) + \ln p(X \mid \theta) 
\tag{9.73}
$$

$$
L(q, \theta) = \sum_Z q(Z) ( \ln p(X, Z \mid \theta) - \ln q(Z) )
= \sum_Z q(Z) ( \ln p(Z \mid X, \theta) + \ln p(X \mid \theta)  - \ln q(Z) ) \\
= \sum_Z q(Z) ( \frac{\ln p(Z \mid X, \theta)}{\ln q(Z)} + \ln p(X \mid \theta) )
= - KL(q \mid\mid p) + \sum_Z q(Z) \ln p(X \mid \theta) \\
= - KL(q \mid\mid p) + \ln p(X \mid \theta)
$$

(9.71)に $ q(Z) = p(Z \mid X, \theta^{old}) $ を代入して
$$
L(q, \theta) = \sum_Z p(Z \mid X, \theta^{old}) \ln \frac{p(X, Z \mid \theta)}{ p(Z \mid X, \theta^{old}) } \\
= \sum_Z p(Z \mid X, \theta^{old}) \ln p(X, Z \mid \theta)
 - \sum_Z p(Z \mid X, \theta^{old}) \ln p(Z \mid X, \theta^{old}) \\
= Q(\theta, \theta^{old}) - \sum_Z q(Z) \ln q(Z) = Q(\theta, \theta^{old}) + H(q)
 

\tag{9.74}

$$


</body>
</html>