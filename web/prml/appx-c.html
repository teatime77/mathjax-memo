<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>付録C 行列の性質</title>
    <script type="text/javascript" src="../js/mymathjax.js" ></script>
</head>
<body>
  <h1>付録C 行列の性質</h1>
$$
\newcommand{\det}{\mathrm{det}}
\\
\newcommand{\tri}{\mathrm{tri}}
\\
\newcommand{\A}{\m{A}}
\\
\newcommand{\B}{\m{B}}
\\
\newcommand{\X}{\m{X}}
\\
\newcommand{\Y}{\m{Y}}
\\
\newcommand{\x}{\m{x}}
\\
\newcommand{\y}{\m{y}}
\\
\newcommand{\b}{\m{b}}
\\
\newcommand{\w}{\m{w}}
\\
\newcommand{\red}[1]{ \color{red}{#1} }
$$

<h3>C.20</h3>
$$
\frac{\partial AB}{\partial \v{x} } = \frac{\partial A}{\partial \v{x} } B + A \frac{\partial B}{\partial \v{x} }


$$

$$
(\frac{\partial AB}{\partial x_s })_{i,j}
= \frac{ \partial \displaystyle \sum_k  a_{i,k} b_{k,j} }{ \partial x_s} 
\\
= \sum_k ( \frac{ \partial a_{i,k} }{ \partial x_s} b_{k,j} + a_{i,k} \frac{ \partial b_{k,j} }{ \partial x_s} )
\\
= \sum_k \frac{ \partial a_{i,k} }{ \partial x_s} b_{k,j} + \sum_k a_{i,k} \frac{ \partial b_{k,j} }{ \partial x_s} 
\\
= (\frac{\partial A}{\partial x_s } B)_{i,j} + (A \frac{\partial B}{\partial x_s })_{i,j}
$$

<hr/>
<h3>C.23</h3>
$$
\frac{\partial}{\partial A_{ij}} Tr(A B) 
\\
= \frac{\partial}{\partial A_{ij}} \sum_k \sum_l A_{kl} B_{lk}
\\
= \frac{\partial}{\partial A_{ij}} A_{ij} B_{ji} = B_{ji}
$$

<hr/>
<h3>C.27</h3>
$$
\frac{\partial}{\partial A} Tr(A B A^T) = A(B + B^T)

$$

$$
\frac{\partial}{\partial A{ij}} Tr(A B A^T)
= \frac{\partial}{\partial A{ij}} \sum_s (A B A^T)_{ss} 
= \frac{\partial}{\partial A{ij}} \sum_s \sum_k A_{sk} (B A^T)_{ks} 
= \frac{\partial}{\partial A{ij}} \sum_s \sum_k A_{sk} (A B^T)_{sk} 
\\
= \sum_s \sum_k \frac{\partial}{\partial A{ij}} A_{sk} (A B^T)_{sk} 
\\
= \sum_s \sum_k (\frac{\partial}{\partial A{ij}} A_{sk}) (A B^T)_{sk} 
+ \sum_s \sum_k A_{sk} \frac{\partial}{\partial A{ij}} (A B^T)_{sk} 
\\
= (A B^T)_{ij}
 + \sum_s \sum_k A_{sk} \frac{\partial}{\partial A{ij}} \sum_t A_{st} (B^T)_{tk}
 \\
 = (A B^T)_{ij} + \sum_k A_{ik} (B^T)_{jk}
  \\
  = (A B^T)_{ij} + \sum_k A_{ik} B_{kj}
  \\
  = (A B^T)_{ij} + (A B)_{ij}
  \\
  = (A (B + B^T))_{ij}
  $$

<hr/>
<h3>C.28</h3>
$$
\frac{\partial}{\partial A} \ln {\mid A \mid} = {(A^{-1})}^T
\tag{C.28} 
$$
(C.22)から
$$
\frac{\partial}{\partial A{ij}} \ln {\mid A \mid} = Tr(A^{-1} \frac{\partial A}{\partial A{ij}} )
\\
= \sum_p {(A^{-1} \frac{\partial A}{\partial A{ij}})}_{pp}
\\
= \sum_p \sum_q {(A^{-1})}_{pq} {(\frac{\partial A}{\partial A{ij}})}_{qp}
\\
= {(A^{-1})}_{ji}
$$
<hr/>
<b> $A$ が対称行列なら$A^{-1}$ も対称行列。</b>
<br/>
証明
$$
A^{-1} A = I
$$
両辺を転置して
$$
{(A^{-1} A)}^T = A^T {(A^{-1})}^T 
\\
= A {(A^{-1})}^T = I
$$

両辺の左から $ A^{-1}$ をかけて
$$
{(A^{-1})}^T = A^{-1}
$$

<hr/>
<b> 上三角行列の逆行列は上三角行列</b><br/>
<a href="http://nalab.mind.meiji.ac.jp/~mk/labo/text/heat-fdm-0-add/node29.html">http://nalab.mind.meiji.ac.jp/~mk/labo/text/heat-fdm-0-add/node29.html</a>
<br/>
$A = (a_{ij})$を上三角行列とする。上三角行列$B = (b_{ij})$で $A B = I$を満たすものが存在することを示す。

$$
\sum_{k=1}^n a_{ik} b_{kj} = \delta_{ij}  \qquad ( 1 \le i \le n, \quad 1 \le j \le n )
$$

上三角行列と上三角行列の積は上三角行列なので、$i \gt j$ なら $\delta_{ij} = 0$ になっている。
<br/>
$i \le j$とする。
<br/>
$i = j$ なら ${(AB)}_{jj} = a_{jj} b_{jj} = 1 $ なので $b_{jj} = \frac{1}{a_{jj}}$
<br/>
任意の$j$に対し$b_{i+1,j} \cdots b_{j,j} $ が既知とする。

$$
\sum_{k=1}^n a_{ik} b_{kj}
$$

$a_{ik} = 0 \quad (k < i) , \qquad b_{kj} = 0 \quad (k > j) $ なので

$$
= \sum_{k=i}^j a_{ik} b_{kj}
\\
= a_{ii} b_{ij} + \sum_{k=i+1}^j a_{ik} b_{kj} = \delta_{ij}
$$

$ \sum_{k=i+1}^j a_{ik} b_{kj} $ の中の $b_{i+1,j} \cdots b_{j,j} $ は既知なので、$b_{ij}$ は容易に計算できる。

<hr/>
<h3>2.44 逆行列の微分</h3>
$ A A^{-1} = I の両辺を $x$で微分すると $

$$
(\frac{\partial A}{\partial x}) A^{-1} + A \frac{\partial A^{-1}}{\partial x} = 0
$$
左から$A^{-1}$をかけて
$$
\frac{\partial A^{-1}}{\partial x} = A^{-1} (\frac{\partial A}{\partial x}) A^{-1}
\tag{2.6} 
$$

<hr/>
<h3>C.22</h3>
$$
\frac{\partial}{\partial x} \ln {\mid A \mid} = Tr(A^{-1} \frac{\partial A}{\partial x})
$$

$$
A = P^{-1} \tri(\lambda_i) P
\\
A^{-1} = P^{-1} \tri(\lambda_i)^{-1} P
$$

$$
\frac{\partial A}{\partial x} = A' = (P^{-1} \tri(\lambda_i) P)'
\\
= (P^{-1})' \tri(\lambda_i) P + P^{-1} \tri({\lambda_i}') P + P^{-1} \tri(\lambda_i) P'
$$

第1項に式(2.6)を使うと
$$
(P^{-1})' \tri(\lambda_i) P = - P^{-1} P' P^{-1} \tri(\lambda_i) P
$$

$$
tr(A^{-1} A')
\\
= tr( (P^{-1} \tri(\lambda_i)^{-1} P) ( - P^{-1} P' P^{-1} \tri(\lambda_i) P + P^{-1} \tri({\lambda_i}') P + P^{-1} \tri(\lambda_i) P' ) )
\\

= - tr ((P^{-1} \tri(\lambda_i)^{-1} P) ( P^{-1} P' P^{-1} \tri(\lambda_i) P ))
\\
+ tr ((P^{-1} \tri(\lambda_i)^{-1} P) ( P^{-1} \tri({\lambda_i}') P ))
\\
+ tr ((P^{-1} \tri(\lambda_i)^{-1} P) ( P^{-1} \tri(\lambda_i) P' ))
\\

= - tr (P^{-1} \tri(\lambda_i)^{-1} P' P^{-1} \tri(\lambda_i) P )
\\
+ tr (P^{-1} \tri(\lambda_i)^{-1}  \tri({\lambda_i}') P )
\\
+ tr (P^{-1} P' )
$$

$tr(AB) = tr(BA)$ を使って
$$
= - tr (P P^{-1} \tri(\lambda_i)^{-1} P' P^{-1} \tri(\lambda_i) )
\\
+ tr (P P^{-1} \tri(\lambda_i)^{-1}  \tri({\lambda_i}') )
\\
+ tr (P^{-1} P' )
\\

= - tr (\tri(\lambda_i)^{-1} P' P^{-1} \tri(\lambda_i) )
\\
+ tr (\tri(\lambda_i)^{-1}  \tri({\lambda_i}') )
\\
+ tr (P^{-1} P' )
\\

= - tr (\tri(\lambda_i) \tri(\lambda_i)^{-1} P' P^{-1} )
\\
+ tr (\tri(\lambda_i)^{-1}  \tri({\lambda_i}') )
\\
+ tr (P^{-1} P' )
\\
= - tr (P' P^{-1} ) + tr (\tri(\lambda_i)^{-1}  \tri({\lambda_i}') ) + tr (P^{-1} P' )
\\
= tr (\tri(\lambda_i)^{-1}  \tri({\lambda_i}') )
$$
三角行列の逆行列は三角行列で、対角成分はもとの対角成分の逆数が並ぶので
$$
\tri(\lambda_i)^{-1} = \tri(\lambda_i^{-1})
$$
よって
$$
tr(A^{-1} A') = tr (\tri(\lambda_i^{-1})  \tri({\lambda_i}') )
= tr (\tri(\lambda_i^{-1} {\lambda_i}' ) )
= \sum \frac{{\lambda_i}'}{\lambda_i}
$$

<hr/>
 

$A$ を $M \times M$ の正方行列(square matrix)とする。

$$
A u_i = \lambda_i u_i  \qquad for \ \  i = 1,...,M \tag{C.29}
$$
$u_i$を固有ベクトル(eigenvector)、$\lambda_i$を固有値(eigenvalue)という。<br/>

解が存在する条件(condition for a solution)は
$$
\mid A - \lambda_i I \mid = 0
\tag{C.30}
$$
この式は$\lambda_i$ のn次の多項式(polynomial of order M)なので、複素数(complex number)の範囲で解を持つ。<br/>
<br/>
式(C.29)に$\red{(u_i^\ast)^T}$をかけて
$$

\red{(u_i^\ast)^T} A u_i = \lambda_i \red{(u_i^\ast)^T} u_i
\tag{C.31}
$$

式(C.29)の複素共役(complex conjugate)はAが実行列(real matrix)なので
$$
A u_i^\ast = \lambda_i^\ast u_i^\ast
$$

$\red{u_i^T}$をかけて
$$
\red{u_i^T} A u_i^\ast = \lambda_i^\ast \red{u_i^T} u_i^\ast
\tag{C.32}
$$

これの転置(transpose)は
$$
(u_i^T A u_i^\ast)^\red{T} = (\lambda_i^\ast u_i^T u_i^\ast)^\red{T}
$$
$A^T=A$を使って
$$
(u_i^\ast)^T A u_i = \lambda_i^\ast (u_i^\ast)^T u_i
$$

これと式(C.31)から $\lambda_i^\ast = \lambda$ となり、$\lambda$ は実数(real)


</body></html>