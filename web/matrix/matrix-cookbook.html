<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8" />
    <title>The Matrix Cookbook</title>
    <script type="text/javascript" src="../js/mymathjax.js" ></script>
</head>
<body>
  <h1>The Matrix Cookbook</h1>

$$
\newcommand{\det}{\mathrm{det}}
\\
\newcommand{\tri}{\mathrm{tri}}
\\
\newcommand{\A}{\m{A}}
\\
\newcommand{\B}{\m{B}}
\\
\newcommand{\X}{\m{X}}
\\
\newcommand{\Y}{\m{Y}}
\\
\newcommand{\x}{\v{x}}
$$

<h3>ベクトル</h3>
$$
\v{a}\T \v{b} \v{c} = \v{c} \v{a}\T \v{b}
$$

<h5>証明</h5>
$$
(\v{a}\T \v{b} \v{c})_i = \sum_j a_j b_j c_i
$$

$$
(\v{c} \v{a}\T \v{b})_i = \sum_j (\v{c} \v{a}\T )_{ij} b_j
= \sum_j c_i a_j b_j
$$
<h3>1 Basics</h3>

$$
(\bm{A B})^{-1} = \bm{B}^{-1} \bm{A}^{-1}
\\
(\m{A B})^{-1} = \m{B}^{-1} \m{A}^{-1}
\\
(\mathrm{A B})^{-1} = \mathrm{B}^{-1} \mathrm{A}^{-1}
\\
(\mathbf{A B})^{-1} = \mathbf{B}^{-1} \mathbf{A}^{-1}
\\
(A B)^{-1} = B^{-1} A^{-1}
\\
\tag{1} 
$$

$$
(\m{A}\T)^{-1} = (\m{A}^{-1})\T
\\
\tag{3} 
$$

$$
(\m{A} + \m{B})\T = \m{A}\T + \m{B}\T
\\
\tag{4} 
$$

$$
(\m{A B})\T = \m{B}\T \m{A}\T
\\
\tag{5} 
$$

<h3>1.1 Trace</h3>

$$
\Tr(\m{A}) = \Tr(\m{A}\T)
\tag{13} 
$$

$$
\Tr(\A \B) = \Tr(\B \A)
\tag{14} 
$$

$$
\Tr(\A + \B) = \Tr(\A) + \Tr(\B)
\tag{15} 
$$

$$
\v{a}\T \v{a} = \Tr(\v{a} \v{a}\T )
\tag{17} 
$$

$\A, \B$を以下で定義する。
$$
\A = (\v{a}_1, \ldots, \v{a}_N)
\\
\B = (\v{b}_1, \ldots, \v{b}_N)
$$

$$
\sum_{n=1}^N \v{a}_n\T \v{b}_n = \Tr(\A\T \B )
$$

<h5>証明</h5>
$$
\A\T \B = (\v{a}_1, \ldots, \v{a}_N)\T 
(\v{b}_1, \ldots, \v{b}_N)
\\
= \left( \begin{array}{c} \v{a}_1\T \\ \vdots \\ \v{a}_N\T  \end{array} \right)
(\v{b}_1, \ldots, \v{b}_N)
\\
= \left(  \begin{array}{ccc}
\v{a}_1\T \v{b}_1 & \ldots & \v{a}_1\T \v{b}_N \\    
  \vdots & \ddots & \vdots \\    
  \v{a}_N\T \v{b}_1 & \ldots & \v{a}_N\T \v{b}_N 
\end{array}\right)
$$

<h3>1.2 Determinant</h3>

$$
\det(\A\T) = \det(\A)
\tag{20}
$$

$$
\det(\A \B) = \det(\A) \det(\B)
\tag{21}
$$

$$
\det(\A^{-1}) = 1 / \det(\A)
\tag{22}
$$

<h3>2 Derivatives</h3>

$$
\partial(\alpha \X) = \alpha \partial \X
\tag{34}
$$

$$
\partial(\X + \Y) = \partial \X + \partial \Y
\tag{35}
$$

$$
\partial(\Tr(\X)) = \Tr(\partial \X)
\tag{36}
$$

$$
\partial(\X \Y) = \partial(\X) \Y + X \partial(\Y)
\tag{37}
$$

$$
\partial(\X\T) = (\partial \X)\T
\tag{44}
$$

<h5>2.4.2 Second Order</h5>

$$
\frac{\partial \x\T\B\x}{\partial \x} = (\B + \B\T)\x
\tag{81}
$$

<h6>証明</h6>
$$
\frac{\partial \x\T \B \x}{\partial x_i}
= \sum_{s,t} b_{st} \frac{\partial x_s x_t}{\partial x_i}
\\
= \sum_t b_{it} x_t + \sum_s b_{si} x_s
\\
= (\B \x)_i + (\B\T \x)_i = ((\B + \B\T)\x)_i

$$
<hr/>
$\B$ が対称行列なら
$$
\frac{\partial \x\T\B\x}{\partial \x} = 2 \B \x
\tag{81.1}
$$

<h4>2.5 Derivatives of Traces</h4>
$$
\frac{\partial }{\partial \X} \Tr(\X \A) = \A\T
\tag{100}
$$

<h5>証明</h5>
$$
( \frac{\partial }{\partial \X} \Tr(\X \A) )_{ij}
= \frac{\partial }{\partial x_{ij}} \sum_{s,t} x_{st} a_{ts} = a_{ji}

$$

<hr/>
$$
\frac{\partial }{\partial \X} \Tr(\X \B \X\T) = \X \B\T + \X \B
\tag{111}
$$

<h5>証明</h5>
$$
\frac{\partial }{\partial x_{ij}} \Tr(\X \B \X\T)
= \frac{\partial }{\partial x_{ij}} \sum_{s,t,u} x_{st} b_{tu} x_{su}
\\
= \sum_{s,t,u} b_{tu} \frac{\partial }{\partial x_{ij}} x_{st} x_{su}
\\
\sum_u \sum_{(s,t) = (i,j)} \frac{\partial }{\partial x_{ij}} x_{st} x_{su} + \sum_t \sum_{(s,u) = (i,j)  } x_{st} x_{su}
\\
= \sum_u b_{ju} x_{iu} + \sum_t b_{tj} x_{it}
\\
= \sum_u x_{iu} b_{ju} + \sum_t x_{it} b_{tj} 
\\
= (\X \B\T)_{ij} + (\X \B)_{ij} = (\X \B\T + \X \B)_{ij}

$$


</body></html>